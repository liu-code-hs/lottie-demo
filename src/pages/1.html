<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>lottie 极简Demo</title>
    <!-- 第一步: 引入CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.7.5/lottie_svg.min.js"></script>
</head>

<body>
    <!-- 第二步: 创建容器 -->
    <div id="container" style="width: 450px;">
       
    </div>
     <button onclick="goToAndPlay()">goToAndPlay</button>
        <button onclick="play()">播放</button>
        <button onclick="pause()">暂停</button>
        <button onclick="stop()">停止</button>
        <button onclick="again()">重新播放</button>
        <button onclick="playSegments()">播放前片段</button>
        <button onclick="playEndSegments()">播放后片段</button>
</body>
<script>
    // 第三步: 实例化
    var animationData = { "v": "4.11.1", "fr": 25, "ip": 0, "op": 60, "w": 750, "h": 1624, "nm": "合成 1", "ddd": 1, "assets": [{ "id": "image_0", "w": 236, "h": 392, "u": "images/", "p": "img_0.png" }, { "id": "image_1", "w": 307, "h": 467, "u": "images/", "p": "img_1.png" }, { "id": "image_2", "w": 541, "h": 542, "u": "images/", "p": "img_2.png" }], "layers": [{ "ddd": 1, "ind": 1, "ty": 2, "nm": "001", "refId": "image_0", "sr": 1, "ks": { "o": { "a": 1, "k": [{ "i": { "x": [0.833], "y": [0.833] }, "o": { "x": [0.167], "y": [0.167] }, "n": ["0p833_0p833_0p167_0p167"], "t": 20, "s": [100], "e": [0] }, { "t": 21 }], "ix": 11 }, "rx": { "a": 0, "k": 0, "ix": 8 }, "ry": { "a": 1, "k": [{ "i": { "x": [0.667], "y": [1] }, "o": { "x": [0.333], "y": [0] }, "n": ["0p667_1_0p333_0"], "t": 10, "s": [0], "e": [40] }, { "i": { "x": [0.667], "y": [1] }, "o": { "x": [0.333], "y": [0] }, "n": ["0p667_1_0p333_0"], "t": 15, "s": [40], "e": [-210] }, { "i": { "x": [0.667], "y": [1] }, "o": { "x": [0.333], "y": [0] }, "n": ["0p667_1_0p333_0"], "t": 25, "s": [-210], "e": [-160] }, { "i": { "x": [0.667], "y": [1] }, "o": { "x": [0.333], "y": [0] }, "n": ["0p667_1_0p333_0"], "t": 30, "s": [-160], "e": [-180] }, { "t": 35 }], "ix": 9 }, "rz": { "a": 0, "k": 0, "ix": 10 }, "or": { "a": 0, "k": [0, 0, 0], "ix": 7 }, "p": { "a": 1, "k": [{ "i": { "x": 0.833, "y": 0.833 }, "o": { "x": 0.167, "y": 0.167 }, "n": "0p833_0p833_0p167_0p167", "t": 0, "s": [374, 790.5, 0], "e": [374, 720.5, 0], "to": [0, -11.6666669845581, 0], "ti": [0, 11.6666669845581, 0] }, { "t": 8 }], "ix": 2 }, "a": { "a": 0, "k": [118, 196, 0], "ix": 1 }, "s": { "a": 1, "k": [{ "i": { "x": [0.833, 0.833, 0.833], "y": [0.833, 0.833, 0.833] }, "o": { "x": [0.167, 0.167, 0.167], "y": [0.167, 0.167, 0.167] }, "n": ["0p833_0p833_0p167_0p167", "0p833_0p833_0p167_0p167", "0p833_0p833_0p167_0p167"], "t": 0, "s": [66, 66, 100], "e": [100, 100, 100] }, { "i": { "x": [0.833, 0.833, 0.833], "y": [0.833, 0.833, 0.833] }, "o": { "x": [0.167, 0.167, 0.167], "y": [0.167, 0.167, 0.167] }, "n": ["0p833_0p833_0p167_0p167", "0p833_0p833_0p167_0p167", "0p833_0p833_0p167_0p167"], "t": 8, "s": [100, 100, 100], "e": [100, 100, 100] }, { "i": { "x": [0.833, 0.833, 0.833], "y": [0.833, 0.833, 0.833] }, "o": { "x": [0.167, 0.167, 0.167], "y": [0.167, 0.167, 0.167] }, "n": ["0p833_0p833_0p167_0p167", "0p833_0p833_0p167_0p167", "0p833_0p833_0p167_0p167"], "t": 19, "s": [100, 100, 100], "e": [-100, 100, 100] }, { "t": 20 }], "ix": 6 } }, "ao": 0, "ip": 0, "op": 60, "st": -90, "bm": 0 }, { "ddd": 1, "ind": 2, "ty": 2, "nm": "002", "refId": "image_1", "sr": 1, "ks": { "o": { "a": 1, "k": [{ "i": { "x": [0.833], "y": [0.833] }, "o": { "x": [0.167], "y": [0.167] }, "n": ["0p833_0p833_0p167_0p167"], "t": 20, "s": [0], "e": [100] }, { "t": 21 }], "ix": 11 }, "rx": { "a": 0, "k": 0, "ix": 8 }, "ry": { "a": 1, "k": [{ "i": { "x": [0.667], "y": [1] }, "o": { "x": [0.333], "y": [0] }, "n": ["0p667_1_0p333_0"], "t": 10, "s": [0], "e": [40] }, { "i": { "x": [0.667], "y": [1] }, "o": { "x": [0.333], "y": [0] }, "n": ["0p667_1_0p333_0"], "t": 15, "s": [40], "e": [-210] }, { "i": { "x": [0.667], "y": [1] }, "o": { "x": [0.333], "y": [0] }, "n": ["0p667_1_0p333_0"], "t": 25, "s": [-210], "e": [-160] }, { "i": { "x": [0.667], "y": [1] }, "o": { "x": [0.333], "y": [0] }, "n": ["0p667_1_0p333_0"], "t": 30, "s": [-160], "e": [-180] }, { "t": 35 }], "ix": 9 }, "rz": { "a": 0, "k": 0, "ix": 10 }, "or": { "a": 0, "k": [0, 0, 0], "ix": 7 }, "p": { "a": 1, "k": [{ "i": { "x": 0.833, "y": 0.833 }, "o": { "x": 0.167, "y": 0.167 }, "n": "0p833_0p833_0p167_0p167", "t": 0, "s": [374, 790.5, 0], "e": [374, 720.5, 0], "to": [0, -11.6666669845581, 0], "ti": [0, 11.6666669845581, 0] }, { "t": 8 }], "ix": 2 }, "a": { "a": 0, "k": [153.5, 233.5, 0], "ix": 1 }, "s": { "a": 1, "k": [{ "i": { "x": [0.833, 0.833, 0.833], "y": [0.833, 0.833, 0.833] }, "o": { "x": [0.167, 0.167, 0.167], "y": [0.167, 0.167, 0.167] }, "n": ["0p833_0p833_0p167_0p167", "0p833_0p833_0p167_0p167", "0p833_0p833_0p167_0p167"], "t": 0, "s": [66, 66, 100], "e": [100, 100, 100] }, { "i": { "x": [0.833, 0.833, 0.833], "y": [0.833, 0.833, 0.833] }, "o": { "x": [0.167, 0.167, 0.167], "y": [0.167, 0.167, 0.167] }, "n": ["0p833_0p833_0p167_0p167", "0p833_0p833_0p167_0p167", "0p833_0p833_0p167_0p167"], "t": 8, "s": [100, 100, 100], "e": [100, 100, 100] }, { "i": { "x": [0.833, 0.833, 0.833], "y": [0.833, 0.833, 0.833] }, "o": { "x": [0.167, 0.167, 0.167], "y": [0.167, 0.167, 0.167] }, "n": ["0p833_0p833_0p167_0p167", "0p833_0p833_0p167_0p167", "0p833_0p833_0p167_0p167"], "t": 19, "s": [100, 100, 100], "e": [-100, 100, 100] }, { "t": 20 }], "ix": 6 } }, "ao": 0, "ip": 0, "op": 60, "st": -90, "bm": 0 }, { "ddd": 0, "ind": 3, "ty": 2, "nm": "003", "refId": "image_2", "sr": 1, "ks": { "o": { "a": 1, "k": [{ "i": { "x": [0.833], "y": [0.833] }, "o": { "x": [0.167], "y": [0.167] }, "n": ["0p833_0p833_0p167_0p167"], "t": 35, "s": [0], "e": [100] }, { "t": 40 }], "ix": 11 }, "r": { "a": 1, "k": [{ "i": { "x": [0.833], "y": [0.833] }, "o": { "x": [0.167], "y": [0.167] }, "n": ["0p833_0p833_0p167_0p167"], "t": 35, "s": [0], "e": [45] }, { "t": 60 }], "ix": 10 }, "p": { "a": 0, "k": [375, 714, 0], "ix": 2 }, "a": { "a": 0, "k": [270.5, 271, 0], "ix": 1 }, "s": { "a": 0, "k": [100, 100, 100], "ix": 6 } }, "ao": 0, "ip": 0, "op": 60, "st": -90, "bm": 0 }] };
    var anim = bodymovin.loadAnimation({
        container: document.getElementById("container"), // 容器
        renderer: "svg",
        loop: false,
        autoplay: false,
        animationData: animationData, //如果使用的是JSON
        rendererSettings: {
            preserveAspectRatio: 'xMidYMid slice'
        },
        path: "./data.json" // the path to the animation json
    });
    var loopCount = 0;
    anim.onLoopComplete = function () {
        loopCount += 1;
        document.getElementById("loop").textContent = `播放了${loopCount}次`;
        if (loopCount >= 3) {
            anim.stop();
        }
    };
    // 播放每一帧都会触发
    var count = 0;
    anim.onEnterFrame = function (res) {
        count += 1;
        console.log(count, 'a')
        if (count == 12) {
            animationData.assets[1].p = 'img_2.png'
        }
    }
    anim.data_ready = function (re) {
        console.log(res, '加载完了！');
    }
    anim.DOMLoaded = function (res) {
        console.log(res, 'DOM已经加载')
    }
    // 播放某个片段触发
    anim.onSegmentStart = function (res) {
        console.log(res, '播放片段')
    }
    // 跳
    function goToAndPlay() {
        // anim.goToAndPlay(1000);
        // anim.goToAndStop(1000);
        anim.goToAndStop(350);
        // anim.setDirection(-1);
    }
    // 暂停
    function pause() {
        anim.pause();
    }
    // 播放
    function play() {
        console.log(anim.renderer.elements[0].elements, 'aa');
        anim.play();
    }
    // 停止
    function stop() {
        anim.stop();
    }
    // again
    function again() {
        stop()
        play()
    }
    // playSegments
    function playSegments() {
        anim.playSegments([0, 12], true)
        anim.renderer.elements[1].innerElem.setAttributeNS(
            'http://www.w3.org/1999/xlink',
            'href',
            'images/img_3.png'
        )
    }
    function playEndSegments() {
        anim.playSegments([13, 60], true);
    }
</script>

</html>